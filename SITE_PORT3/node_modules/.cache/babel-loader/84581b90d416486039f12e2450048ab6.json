{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { applyMixins, cloneObj, forEach, has, isEmpty, map, toFastProperties, values } from \"../../utils/utils\";\nimport { computeAllProdsFollows } from \"../grammar/follow\";\nimport { createTokenInstance, EOF } from \"../../scan/tokens_public\";\nimport { defaultGrammarValidatorErrorProvider, defaultParserErrorProvider } from \"../errors_public\";\nimport { resolveGrammar, validateGrammar } from \"../grammar/gast/gast_resolver_public\";\nimport { Recoverable } from \"./traits/recoverable\";\nimport { LooksAhead } from \"./traits/looksahead\";\nimport { TreeBuilder } from \"./traits/tree_builder\";\nimport { LexerAdapter } from \"./traits/lexer_adapter\";\nimport { RecognizerApi } from \"./traits/recognizer_api\";\nimport { RecognizerEngine } from \"./traits/recognizer_engine\";\nimport { ErrorHandler } from \"./traits/error_handler\";\nimport { ContentAssist } from \"./traits/context_assist\";\nimport { GastRecorder } from \"./traits/gast_recorder\";\nimport { PerformanceTracer } from \"./traits/perf_tracer\";\nexport var END_OF_FILE = createTokenInstance(EOF, \"\", NaN, NaN, NaN, NaN, NaN, NaN);\nObject.freeze(END_OF_FILE);\nexport var DEFAULT_PARSER_CONFIG = Object.freeze({\n  recoveryEnabled: false,\n  maxLookahead: 3,\n  dynamicTokensEnabled: false,\n  outputCst: true,\n  errorMessageProvider: defaultParserErrorProvider,\n  nodeLocationTracking: \"none\",\n  traceInitPerf: false,\n  skipValidations: false\n});\nexport var DEFAULT_RULE_CONFIG = Object.freeze({\n  recoveryValueFunc: function () {\n    return undefined;\n  },\n  resyncEnabled: true\n});\nexport var ParserDefinitionErrorType;\n(function (ParserDefinitionErrorType) {\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_RULE_NAME\"] = 0] = \"INVALID_RULE_NAME\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"DUPLICATE_RULE_NAME\"] = 1] = \"DUPLICATE_RULE_NAME\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_RULE_OVERRIDE\"] = 2] = \"INVALID_RULE_OVERRIDE\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"DUPLICATE_PRODUCTIONS\"] = 3] = \"DUPLICATE_PRODUCTIONS\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"UNRESOLVED_SUBRULE_REF\"] = 4] = \"UNRESOLVED_SUBRULE_REF\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"LEFT_RECURSION\"] = 5] = \"LEFT_RECURSION\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"NONE_LAST_EMPTY_ALT\"] = 6] = \"NONE_LAST_EMPTY_ALT\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"AMBIGUOUS_ALTS\"] = 7] = \"AMBIGUOUS_ALTS\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"CONFLICT_TOKENS_RULES_NAMESPACE\"] = 8] = \"CONFLICT_TOKENS_RULES_NAMESPACE\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_TOKEN_NAME\"] = 9] = \"INVALID_TOKEN_NAME\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"NO_NON_EMPTY_LOOKAHEAD\"] = 10] = \"NO_NON_EMPTY_LOOKAHEAD\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"AMBIGUOUS_PREFIX_ALTS\"] = 11] = \"AMBIGUOUS_PREFIX_ALTS\";\n  ParserDefinitionErrorType[ParserDefinitionErrorType[\"TOO_MANY_ALTS\"] = 12] = \"TOO_MANY_ALTS\";\n})(ParserDefinitionErrorType || (ParserDefinitionErrorType = {}));\nexport function EMPTY_ALT(value) {\n  if (value === void 0) {\n    value = undefined;\n  }\n  return function () {\n    return value;\n  };\n}\nvar Parser = /** @class */function () {\n  function Parser(tokenVocabulary, config) {\n    this.definitionErrors = [];\n    this.selfAnalysisDone = false;\n    var that = this;\n    that.initErrorHandler(config);\n    that.initLexerAdapter();\n    that.initLooksAhead(config);\n    that.initRecognizerEngine(tokenVocabulary, config);\n    that.initRecoverable(config);\n    that.initTreeBuilder(config);\n    that.initContentAssist();\n    that.initGastRecorder(config);\n    that.initPerformanceTracer(config);\n    if (has(config, \"ignoredIssues\")) {\n      throw new Error(\"The <ignoredIssues> IParserConfig property has been deprecated.\\n\\t\" + \"Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\\n\\t\" + \"See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\\n\\t\" + \"For further details.\");\n    }\n    this.skipValidations = has(config, \"skipValidations\") ? config.skipValidations : DEFAULT_PARSER_CONFIG.skipValidations;\n  }\n  /**\n   *  @deprecated use the **instance** method with the same name instead\n   */\n  Parser.performSelfAnalysis = function (parserInstance) {\n    throw Error(\"The **static** `performSelfAnalysis` method has been deprecated.\" + \"\\t\\nUse the **instance** method with the same name instead.\");\n  };\n  Parser.prototype.performSelfAnalysis = function () {\n    var _this = this;\n    this.TRACE_INIT(\"performSelfAnalysis\", function () {\n      var defErrorsMsgs;\n      _this.selfAnalysisDone = true;\n      var className = _this.className;\n      _this.TRACE_INIT(\"toFastProps\", function () {\n        // Without this voodoo magic the parser would be x3-x4 slower\n        // It seems it is better to invoke `toFastProperties` **before**\n        // Any manipulations of the `this` object done during the recording phase.\n        toFastProperties(_this);\n      });\n      _this.TRACE_INIT(\"Grammar Recording\", function () {\n        try {\n          _this.enableRecording();\n          // Building the GAST\n          forEach(_this.definedRulesNames, function (currRuleName) {\n            var wrappedRule = _this[currRuleName];\n            var originalGrammarAction = wrappedRule[\"originalGrammarAction\"];\n            var recordedRuleGast = undefined;\n            _this.TRACE_INIT(currRuleName + \" Rule\", function () {\n              recordedRuleGast = _this.topLevelRuleRecord(currRuleName, originalGrammarAction);\n            });\n            _this.gastProductionsCache[currRuleName] = recordedRuleGast;\n          });\n        } finally {\n          _this.disableRecording();\n        }\n      });\n      var resolverErrors = [];\n      _this.TRACE_INIT(\"Grammar Resolving\", function () {\n        resolverErrors = resolveGrammar({\n          rules: values(_this.gastProductionsCache)\n        });\n        _this.definitionErrors.push.apply(_this.definitionErrors, resolverErrors); // mutability for the win?\n      });\n      _this.TRACE_INIT(\"Grammar Validations\", function () {\n        // only perform additional grammar validations IFF no resolving errors have occurred.\n        // as unresolved grammar may lead to unhandled runtime exceptions in the follow up validations.\n        if (isEmpty(resolverErrors) && _this.skipValidations === false) {\n          var validationErrors = validateGrammar({\n            rules: values(_this.gastProductionsCache),\n            maxLookahead: _this.maxLookahead,\n            tokenTypes: values(_this.tokensMap),\n            errMsgProvider: defaultGrammarValidatorErrorProvider,\n            grammarName: className\n          });\n          _this.definitionErrors.push.apply(_this.definitionErrors, validationErrors); // mutability for the win?\n        }\n      });\n      // this analysis may fail if the grammar is not perfectly valid\n      if (isEmpty(_this.definitionErrors)) {\n        // The results of these computations are not needed unless error recovery is enabled.\n        if (_this.recoveryEnabled) {\n          _this.TRACE_INIT(\"computeAllProdsFollows\", function () {\n            var allFollows = computeAllProdsFollows(values(_this.gastProductionsCache));\n            _this.resyncFollows = allFollows;\n          });\n        }\n        _this.TRACE_INIT(\"ComputeLookaheadFunctions\", function () {\n          _this.preComputeLookaheadFunctions(values(_this.gastProductionsCache));\n        });\n      }\n      if (!Parser.DEFER_DEFINITION_ERRORS_HANDLING && !isEmpty(_this.definitionErrors)) {\n        defErrorsMsgs = map(_this.definitionErrors, function (defError) {\n          return defError.message;\n        });\n        throw new Error(\"Parser Definition Errors detected:\\n \" + defErrorsMsgs.join(\"\\n-------------------------------\\n\"));\n      }\n    });\n  };\n  // Set this flag to true if you don't want the Parser to throw error when problems in it's definition are detected.\n  // (normally during the parser's constructor).\n  // This is a design time flag, it will not affect the runtime error handling of the parser, just design time errors,\n  // for example: duplicate rule names, referencing an unresolved subrule, ect...\n  // This flag should not be enabled during normal usage, it is used in special situations, for example when\n  // needing to display the parser definition errors in some GUI(online playground).\n  Parser.DEFER_DEFINITION_ERRORS_HANDLING = false;\n  return Parser;\n}();\nexport { Parser };\napplyMixins(Parser, [Recoverable, LooksAhead, TreeBuilder, LexerAdapter, RecognizerEngine, RecognizerApi, ErrorHandler, ContentAssist, GastRecorder, PerformanceTracer]);\nvar CstParser = /** @class */function (_super) {\n  __extends(CstParser, _super);\n  function CstParser(tokenVocabulary, config) {\n    if (config === void 0) {\n      config = DEFAULT_PARSER_CONFIG;\n    }\n    var _this = this;\n    var configClone = cloneObj(config);\n    configClone.outputCst = true;\n    _this = _super.call(this, tokenVocabulary, configClone) || this;\n    return _this;\n  }\n  return CstParser;\n}(Parser);\nexport { CstParser };\nvar EmbeddedActionsParser = /** @class */function (_super) {\n  __extends(EmbeddedActionsParser, _super);\n  function EmbeddedActionsParser(tokenVocabulary, config) {\n    if (config === void 0) {\n      config = DEFAULT_PARSER_CONFIG;\n    }\n    var _this = this;\n    var configClone = cloneObj(config);\n    configClone.outputCst = false;\n    _this = _super.call(this, tokenVocabulary, configClone) || this;\n    return _this;\n  }\n  return EmbeddedActionsParser;\n}(Parser);\nexport { EmbeddedActionsParser };","map":{"version":3,"sources":["../../../../src/parse/parser/parser.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { applyMixins, cloneObj, forEach, has, isEmpty, map, toFastProperties, values } from \"../../utils/utils\";\nimport { computeAllProdsFollows } from \"../grammar/follow\";\nimport { createTokenInstance, EOF } from \"../../scan/tokens_public\";\nimport { defaultGrammarValidatorErrorProvider, defaultParserErrorProvider } from \"../errors_public\";\nimport { resolveGrammar, validateGrammar } from \"../grammar/gast/gast_resolver_public\";\nimport { Recoverable } from \"./traits/recoverable\";\nimport { LooksAhead } from \"./traits/looksahead\";\nimport { TreeBuilder } from \"./traits/tree_builder\";\nimport { LexerAdapter } from \"./traits/lexer_adapter\";\nimport { RecognizerApi } from \"./traits/recognizer_api\";\nimport { RecognizerEngine } from \"./traits/recognizer_engine\";\nimport { ErrorHandler } from \"./traits/error_handler\";\nimport { ContentAssist } from \"./traits/context_assist\";\nimport { GastRecorder } from \"./traits/gast_recorder\";\nimport { PerformanceTracer } from \"./traits/perf_tracer\";\nexport var END_OF_FILE = createTokenInstance(EOF, \"\", NaN, NaN, NaN, NaN, NaN, NaN);\nObject.freeze(END_OF_FILE);\nexport var DEFAULT_PARSER_CONFIG = Object.freeze({\n    recoveryEnabled: false,\n    maxLookahead: 3,\n    dynamicTokensEnabled: false,\n    outputCst: true,\n    errorMessageProvider: defaultParserErrorProvider,\n    nodeLocationTracking: \"none\",\n    traceInitPerf: false,\n    skipValidations: false\n});\nexport var DEFAULT_RULE_CONFIG = Object.freeze({\n    recoveryValueFunc: function () { return undefined; },\n    resyncEnabled: true\n});\nexport var ParserDefinitionErrorType;\n(function (ParserDefinitionErrorType) {\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_RULE_NAME\"] = 0] = \"INVALID_RULE_NAME\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"DUPLICATE_RULE_NAME\"] = 1] = \"DUPLICATE_RULE_NAME\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_RULE_OVERRIDE\"] = 2] = \"INVALID_RULE_OVERRIDE\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"DUPLICATE_PRODUCTIONS\"] = 3] = \"DUPLICATE_PRODUCTIONS\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"UNRESOLVED_SUBRULE_REF\"] = 4] = \"UNRESOLVED_SUBRULE_REF\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"LEFT_RECURSION\"] = 5] = \"LEFT_RECURSION\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"NONE_LAST_EMPTY_ALT\"] = 6] = \"NONE_LAST_EMPTY_ALT\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"AMBIGUOUS_ALTS\"] = 7] = \"AMBIGUOUS_ALTS\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"CONFLICT_TOKENS_RULES_NAMESPACE\"] = 8] = \"CONFLICT_TOKENS_RULES_NAMESPACE\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"INVALID_TOKEN_NAME\"] = 9] = \"INVALID_TOKEN_NAME\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"NO_NON_EMPTY_LOOKAHEAD\"] = 10] = \"NO_NON_EMPTY_LOOKAHEAD\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"AMBIGUOUS_PREFIX_ALTS\"] = 11] = \"AMBIGUOUS_PREFIX_ALTS\";\n    ParserDefinitionErrorType[ParserDefinitionErrorType[\"TOO_MANY_ALTS\"] = 12] = \"TOO_MANY_ALTS\";\n})(ParserDefinitionErrorType || (ParserDefinitionErrorType = {}));\nexport function EMPTY_ALT(value) {\n    if (value === void 0) { value = undefined; }\n    return function () {\n        return value;\n    };\n}\nvar Parser = /** @class */ (function () {\n    function Parser(tokenVocabulary, config) {\n        this.definitionErrors = [];\n        this.selfAnalysisDone = false;\n        var that = this;\n        that.initErrorHandler(config);\n        that.initLexerAdapter();\n        that.initLooksAhead(config);\n        that.initRecognizerEngine(tokenVocabulary, config);\n        that.initRecoverable(config);\n        that.initTreeBuilder(config);\n        that.initContentAssist();\n        that.initGastRecorder(config);\n        that.initPerformanceTracer(config);\n        if (has(config, \"ignoredIssues\")) {\n            throw new Error(\"The <ignoredIssues> IParserConfig property has been deprecated.\\n\\t\" +\n                \"Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\\n\\t\" +\n                \"See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\\n\\t\" +\n                \"For further details.\");\n        }\n        this.skipValidations = has(config, \"skipValidations\")\n            ? config.skipValidations\n            : DEFAULT_PARSER_CONFIG.skipValidations;\n    }\n    /**\n     *  @deprecated use the **instance** method with the same name instead\n     */\n    Parser.performSelfAnalysis = function (parserInstance) {\n        throw Error(\"The **static** `performSelfAnalysis` method has been deprecated.\" +\n            \"\\t\\nUse the **instance** method with the same name instead.\");\n    };\n    Parser.prototype.performSelfAnalysis = function () {\n        var _this = this;\n        this.TRACE_INIT(\"performSelfAnalysis\", function () {\n            var defErrorsMsgs;\n            _this.selfAnalysisDone = true;\n            var className = _this.className;\n            _this.TRACE_INIT(\"toFastProps\", function () {\n                // Without this voodoo magic the parser would be x3-x4 slower\n                // It seems it is better to invoke `toFastProperties` **before**\n                // Any manipulations of the `this` object done during the recording phase.\n                toFastProperties(_this);\n            });\n            _this.TRACE_INIT(\"Grammar Recording\", function () {\n                try {\n                    _this.enableRecording();\n                    // Building the GAST\n                    forEach(_this.definedRulesNames, function (currRuleName) {\n                        var wrappedRule = _this[currRuleName];\n                        var originalGrammarAction = wrappedRule[\"originalGrammarAction\"];\n                        var recordedRuleGast = undefined;\n                        _this.TRACE_INIT(currRuleName + \" Rule\", function () {\n                            recordedRuleGast = _this.topLevelRuleRecord(currRuleName, originalGrammarAction);\n                        });\n                        _this.gastProductionsCache[currRuleName] = recordedRuleGast;\n                    });\n                }\n                finally {\n                    _this.disableRecording();\n                }\n            });\n            var resolverErrors = [];\n            _this.TRACE_INIT(\"Grammar Resolving\", function () {\n                resolverErrors = resolveGrammar({\n                    rules: values(_this.gastProductionsCache)\n                });\n                _this.definitionErrors.push.apply(_this.definitionErrors, resolverErrors); // mutability for the win?\n            });\n            _this.TRACE_INIT(\"Grammar Validations\", function () {\n                // only perform additional grammar validations IFF no resolving errors have occurred.\n                // as unresolved grammar may lead to unhandled runtime exceptions in the follow up validations.\n                if (isEmpty(resolverErrors) && _this.skipValidations === false) {\n                    var validationErrors = validateGrammar({\n                        rules: values(_this.gastProductionsCache),\n                        maxLookahead: _this.maxLookahead,\n                        tokenTypes: values(_this.tokensMap),\n                        errMsgProvider: defaultGrammarValidatorErrorProvider,\n                        grammarName: className\n                    });\n                    _this.definitionErrors.push.apply(_this.definitionErrors, validationErrors); // mutability for the win?\n                }\n            });\n            // this analysis may fail if the grammar is not perfectly valid\n            if (isEmpty(_this.definitionErrors)) {\n                // The results of these computations are not needed unless error recovery is enabled.\n                if (_this.recoveryEnabled) {\n                    _this.TRACE_INIT(\"computeAllProdsFollows\", function () {\n                        var allFollows = computeAllProdsFollows(values(_this.gastProductionsCache));\n                        _this.resyncFollows = allFollows;\n                    });\n                }\n                _this.TRACE_INIT(\"ComputeLookaheadFunctions\", function () {\n                    _this.preComputeLookaheadFunctions(values(_this.gastProductionsCache));\n                });\n            }\n            if (!Parser.DEFER_DEFINITION_ERRORS_HANDLING &&\n                !isEmpty(_this.definitionErrors)) {\n                defErrorsMsgs = map(_this.definitionErrors, function (defError) { return defError.message; });\n                throw new Error(\"Parser Definition Errors detected:\\n \" + defErrorsMsgs.join(\"\\n-------------------------------\\n\"));\n            }\n        });\n    };\n    // Set this flag to true if you don't want the Parser to throw error when problems in it's definition are detected.\n    // (normally during the parser's constructor).\n    // This is a design time flag, it will not affect the runtime error handling of the parser, just design time errors,\n    // for example: duplicate rule names, referencing an unresolved subrule, ect...\n    // This flag should not be enabled during normal usage, it is used in special situations, for example when\n    // needing to display the parser definition errors in some GUI(online playground).\n    Parser.DEFER_DEFINITION_ERRORS_HANDLING = false;\n    return Parser;\n}());\nexport { Parser };\napplyMixins(Parser, [\n    Recoverable,\n    LooksAhead,\n    TreeBuilder,\n    LexerAdapter,\n    RecognizerEngine,\n    RecognizerApi,\n    ErrorHandler,\n    ContentAssist,\n    GastRecorder,\n    PerformanceTracer\n]);\nvar CstParser = /** @class */ (function (_super) {\n    __extends(CstParser, _super);\n    function CstParser(tokenVocabulary, config) {\n        if (config === void 0) { config = DEFAULT_PARSER_CONFIG; }\n        var _this = this;\n        var configClone = cloneObj(config);\n        configClone.outputCst = true;\n        _this = _super.call(this, tokenVocabulary, configClone) || this;\n        return _this;\n    }\n    return CstParser;\n}(Parser));\nexport { CstParser };\nvar EmbeddedActionsParser = /** @class */ (function (_super) {\n    __extends(EmbeddedActionsParser, _super);\n    function EmbeddedActionsParser(tokenVocabulary, config) {\n        if (config === void 0) { config = DEFAULT_PARSER_CONFIG; }\n        var _this = this;\n        var configClone = cloneObj(config);\n        configClone.outputCst = false;\n        _this = _super.call(this, tokenVocabulary, configClone) || this;\n        return _this;\n    }\n    return EmbeddedActionsParser;\n}(Parser));\nexport { EmbeddedActionsParser };\n//# sourceMappingURL=parser.js.map"]},"metadata":{},"sourceType":"module"}