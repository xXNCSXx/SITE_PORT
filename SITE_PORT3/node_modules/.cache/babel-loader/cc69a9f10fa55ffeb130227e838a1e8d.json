{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { assign, forEach, isRegExp, map, pick } from \"../../../utils/utils\";\nimport { tokenLabel } from \"../../../scan/tokens_public\";\nvar AbstractProduction = /** @class */function () {\n  function AbstractProduction(_definition) {\n    this._definition = _definition;\n  }\n  Object.defineProperty(AbstractProduction.prototype, \"definition\", {\n    get: function () {\n      return this._definition;\n    },\n    set: function (value) {\n      this._definition = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  AbstractProduction.prototype.accept = function (visitor) {\n    visitor.visit(this);\n    forEach(this.definition, function (prod) {\n      prod.accept(visitor);\n    });\n  };\n  return AbstractProduction;\n}();\nexport { AbstractProduction };\nvar NonTerminal = /** @class */function (_super) {\n  __extends(NonTerminal, _super);\n  function NonTerminal(options) {\n    var _this = _super.call(this, []) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  Object.defineProperty(NonTerminal.prototype, \"definition\", {\n    get: function () {\n      if (this.referencedRule !== undefined) {\n        return this.referencedRule.definition;\n      }\n      return [];\n    },\n    set: function (definition) {\n      // immutable\n    },\n    enumerable: false,\n    configurable: true\n  });\n  NonTerminal.prototype.accept = function (visitor) {\n    visitor.visit(this);\n    // don't visit children of a reference, we will get cyclic infinite loops if we do so\n  };\n  return NonTerminal;\n}(AbstractProduction);\nexport { NonTerminal };\nvar Rule = /** @class */function (_super) {\n  __extends(Rule, _super);\n  function Rule(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.orgText = \"\";\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return Rule;\n}(AbstractProduction);\nexport { Rule };\nvar Alternative = /** @class */function (_super) {\n  __extends(Alternative, _super);\n  function Alternative(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.ignoreAmbiguities = false;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return Alternative;\n}(AbstractProduction);\nexport { Alternative };\nvar Option = /** @class */function (_super) {\n  __extends(Option, _super);\n  function Option(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return Option;\n}(AbstractProduction);\nexport { Option };\nvar RepetitionMandatory = /** @class */function (_super) {\n  __extends(RepetitionMandatory, _super);\n  function RepetitionMandatory(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return RepetitionMandatory;\n}(AbstractProduction);\nexport { RepetitionMandatory };\nvar RepetitionMandatoryWithSeparator = /** @class */function (_super) {\n  __extends(RepetitionMandatoryWithSeparator, _super);\n  function RepetitionMandatoryWithSeparator(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return RepetitionMandatoryWithSeparator;\n}(AbstractProduction);\nexport { RepetitionMandatoryWithSeparator };\nvar Repetition = /** @class */function (_super) {\n  __extends(Repetition, _super);\n  function Repetition(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return Repetition;\n}(AbstractProduction);\nexport { Repetition };\nvar RepetitionWithSeparator = /** @class */function (_super) {\n  __extends(RepetitionWithSeparator, _super);\n  function RepetitionWithSeparator(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  return RepetitionWithSeparator;\n}(AbstractProduction);\nexport { RepetitionWithSeparator };\nvar Alternation = /** @class */function (_super) {\n  __extends(Alternation, _super);\n  function Alternation(options) {\n    var _this = _super.call(this, options.definition) || this;\n    _this.idx = 1;\n    _this.ignoreAmbiguities = false;\n    _this.hasPredicates = false;\n    assign(_this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n    return _this;\n  }\n  Object.defineProperty(Alternation.prototype, \"definition\", {\n    get: function () {\n      return this._definition;\n    },\n    set: function (value) {\n      this._definition = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return Alternation;\n}(AbstractProduction);\nexport { Alternation };\nvar Terminal = /** @class */function () {\n  function Terminal(options) {\n    this.idx = 1;\n    assign(this, pick(options, function (v) {\n      return v !== undefined;\n    }));\n  }\n  Terminal.prototype.accept = function (visitor) {\n    visitor.visit(this);\n  };\n  return Terminal;\n}();\nexport { Terminal };\nexport function serializeGrammar(topRules) {\n  return map(topRules, serializeProduction);\n}\nexport function serializeProduction(node) {\n  function convertDefinition(definition) {\n    return map(definition, serializeProduction);\n  }\n  /* istanbul ignore else */\n  if (node instanceof NonTerminal) {\n    return {\n      type: \"NonTerminal\",\n      name: node.nonTerminalName,\n      idx: node.idx\n    };\n  } else if (node instanceof Alternative) {\n    return {\n      type: \"Alternative\",\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof Option) {\n    return {\n      type: \"Option\",\n      idx: node.idx,\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof RepetitionMandatory) {\n    return {\n      type: \"RepetitionMandatory\",\n      idx: node.idx,\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof RepetitionMandatoryWithSeparator) {\n    return {\n      type: \"RepetitionMandatoryWithSeparator\",\n      idx: node.idx,\n      separator: serializeProduction(new Terminal({\n        terminalType: node.separator\n      })),\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof RepetitionWithSeparator) {\n    return {\n      type: \"RepetitionWithSeparator\",\n      idx: node.idx,\n      separator: serializeProduction(new Terminal({\n        terminalType: node.separator\n      })),\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof Repetition) {\n    return {\n      type: \"Repetition\",\n      idx: node.idx,\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof Alternation) {\n    return {\n      type: \"Alternation\",\n      idx: node.idx,\n      definition: convertDefinition(node.definition)\n    };\n  } else if (node instanceof Terminal) {\n    var serializedTerminal = {\n      type: \"Terminal\",\n      name: node.terminalType.name,\n      label: tokenLabel(node.terminalType),\n      idx: node.idx\n    };\n    var pattern = node.terminalType.PATTERN;\n    if (node.terminalType.PATTERN) {\n      serializedTerminal.pattern = isRegExp(pattern) ? pattern.source : pattern;\n    }\n    return serializedTerminal;\n  } else if (node instanceof Rule) {\n    return {\n      type: \"Rule\",\n      name: node.name,\n      orgText: node.orgText,\n      definition: convertDefinition(node.definition)\n    };\n  } else {\n    throw Error(\"non exhaustive match\");\n  }\n}","map":{"version":3,"sources":["../../../../../src/parse/grammar/gast/gast_public.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { assign, forEach, isRegExp, map, pick } from \"../../../utils/utils\";\nimport { tokenLabel } from \"../../../scan/tokens_public\";\nvar AbstractProduction = /** @class */ (function () {\n    function AbstractProduction(_definition) {\n        this._definition = _definition;\n    }\n    Object.defineProperty(AbstractProduction.prototype, \"definition\", {\n        get: function () {\n            return this._definition;\n        },\n        set: function (value) {\n            this._definition = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    AbstractProduction.prototype.accept = function (visitor) {\n        visitor.visit(this);\n        forEach(this.definition, function (prod) {\n            prod.accept(visitor);\n        });\n    };\n    return AbstractProduction;\n}());\nexport { AbstractProduction };\nvar NonTerminal = /** @class */ (function (_super) {\n    __extends(NonTerminal, _super);\n    function NonTerminal(options) {\n        var _this = _super.call(this, []) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    Object.defineProperty(NonTerminal.prototype, \"definition\", {\n        get: function () {\n            if (this.referencedRule !== undefined) {\n                return this.referencedRule.definition;\n            }\n            return [];\n        },\n        set: function (definition) {\n            // immutable\n        },\n        enumerable: false,\n        configurable: true\n    });\n    NonTerminal.prototype.accept = function (visitor) {\n        visitor.visit(this);\n        // don't visit children of a reference, we will get cyclic infinite loops if we do so\n    };\n    return NonTerminal;\n}(AbstractProduction));\nexport { NonTerminal };\nvar Rule = /** @class */ (function (_super) {\n    __extends(Rule, _super);\n    function Rule(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.orgText = \"\";\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return Rule;\n}(AbstractProduction));\nexport { Rule };\nvar Alternative = /** @class */ (function (_super) {\n    __extends(Alternative, _super);\n    function Alternative(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.ignoreAmbiguities = false;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return Alternative;\n}(AbstractProduction));\nexport { Alternative };\nvar Option = /** @class */ (function (_super) {\n    __extends(Option, _super);\n    function Option(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return Option;\n}(AbstractProduction));\nexport { Option };\nvar RepetitionMandatory = /** @class */ (function (_super) {\n    __extends(RepetitionMandatory, _super);\n    function RepetitionMandatory(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return RepetitionMandatory;\n}(AbstractProduction));\nexport { RepetitionMandatory };\nvar RepetitionMandatoryWithSeparator = /** @class */ (function (_super) {\n    __extends(RepetitionMandatoryWithSeparator, _super);\n    function RepetitionMandatoryWithSeparator(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return RepetitionMandatoryWithSeparator;\n}(AbstractProduction));\nexport { RepetitionMandatoryWithSeparator };\nvar Repetition = /** @class */ (function (_super) {\n    __extends(Repetition, _super);\n    function Repetition(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return Repetition;\n}(AbstractProduction));\nexport { Repetition };\nvar RepetitionWithSeparator = /** @class */ (function (_super) {\n    __extends(RepetitionWithSeparator, _super);\n    function RepetitionWithSeparator(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    return RepetitionWithSeparator;\n}(AbstractProduction));\nexport { RepetitionWithSeparator };\nvar Alternation = /** @class */ (function (_super) {\n    __extends(Alternation, _super);\n    function Alternation(options) {\n        var _this = _super.call(this, options.definition) || this;\n        _this.idx = 1;\n        _this.ignoreAmbiguities = false;\n        _this.hasPredicates = false;\n        assign(_this, pick(options, function (v) { return v !== undefined; }));\n        return _this;\n    }\n    Object.defineProperty(Alternation.prototype, \"definition\", {\n        get: function () {\n            return this._definition;\n        },\n        set: function (value) {\n            this._definition = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Alternation;\n}(AbstractProduction));\nexport { Alternation };\nvar Terminal = /** @class */ (function () {\n    function Terminal(options) {\n        this.idx = 1;\n        assign(this, pick(options, function (v) { return v !== undefined; }));\n    }\n    Terminal.prototype.accept = function (visitor) {\n        visitor.visit(this);\n    };\n    return Terminal;\n}());\nexport { Terminal };\nexport function serializeGrammar(topRules) {\n    return map(topRules, serializeProduction);\n}\nexport function serializeProduction(node) {\n    function convertDefinition(definition) {\n        return map(definition, serializeProduction);\n    }\n    /* istanbul ignore else */\n    if (node instanceof NonTerminal) {\n        return {\n            type: \"NonTerminal\",\n            name: node.nonTerminalName,\n            idx: node.idx\n        };\n    }\n    else if (node instanceof Alternative) {\n        return {\n            type: \"Alternative\",\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof Option) {\n        return {\n            type: \"Option\",\n            idx: node.idx,\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof RepetitionMandatory) {\n        return {\n            type: \"RepetitionMandatory\",\n            idx: node.idx,\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof RepetitionMandatoryWithSeparator) {\n        return {\n            type: \"RepetitionMandatoryWithSeparator\",\n            idx: node.idx,\n            separator: (serializeProduction(new Terminal({ terminalType: node.separator }))),\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof RepetitionWithSeparator) {\n        return {\n            type: \"RepetitionWithSeparator\",\n            idx: node.idx,\n            separator: (serializeProduction(new Terminal({ terminalType: node.separator }))),\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof Repetition) {\n        return {\n            type: \"Repetition\",\n            idx: node.idx,\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof Alternation) {\n        return {\n            type: \"Alternation\",\n            idx: node.idx,\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else if (node instanceof Terminal) {\n        var serializedTerminal = {\n            type: \"Terminal\",\n            name: node.terminalType.name,\n            label: tokenLabel(node.terminalType),\n            idx: node.idx\n        };\n        var pattern = node.terminalType.PATTERN;\n        if (node.terminalType.PATTERN) {\n            serializedTerminal.pattern = isRegExp(pattern)\n                ? pattern.source\n                : pattern;\n        }\n        return serializedTerminal;\n    }\n    else if (node instanceof Rule) {\n        return {\n            type: \"Rule\",\n            name: node.name,\n            orgText: node.orgText,\n            definition: convertDefinition(node.definition)\n        };\n    }\n    else {\n        throw Error(\"non exhaustive match\");\n    }\n}\n//# sourceMappingURL=gast_public.js.map"]},"metadata":{},"sourceType":"module"}